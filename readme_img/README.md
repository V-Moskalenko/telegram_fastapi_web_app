# Telegram Web App: Aiogram + FastAPI webhook приложение 

Данный проект представляет собой бота Учебного центра, с использованием **FastAPI** для поднятия веб-сервера и обработки запросов, а также с реализацией Telegram MiniApp для приёма заявок на коммерческое предложение и их обработки.
Бот работает через webhook и взаимодействует с базой данных, с использованием асинхронной **SQLAlchemy**.
Веб-приложение имеет функционал приёма заявок от клиентов, просмотр заявок клиентов и панель администратора для обработки 
заявок и формирования коммерческого предложения в Word формате.

## Стек технологий:
- **Backend**: FastAPI
- **Telegram Bot**: Aiogram
- **Telegram API**: Webhooks
- **ORM**: SQLAlchemy (aiosqlite)
- **База данных**: SQLite
- **Миграции**: Alembic
- **Валидация**: Pydantic

### Установка зависимостей:
```bash
pip install -r requirements.txt
```

### Переменные среды
В проект необходимо добавить .env файл, со следующими переменными
* BOT_TOKEN - токен телеграм бота
* BASE_SITE - домен приложения
* ADMIN_ID - ID телеграм аккаунта администратора

## Функционал:
### **1. Регистрация клиентов:**
<img src="/readme_img/1.jpg" width="299" height="584"/>

При команде start бота, приложение ищет в базе данных пользователя и выводит приветствие, если
пользователь не найден - произведется добавление его в базу данных.

### **2. Прием заявок через Telegram MiniApp:**
Пользователи могут отправить заявку на коммерческое предложение по образовательным услугам
выбирая вид и программы обучения. В одну заявку может быть добавлено несколько услуг.

<img src="/readme_img/2.jpg" width="237" height="624"/>
<img src="/readme_img/3.jpg" width="299" height="624"/>


После регистрации заявки, происходит оповещение в Телеграм

Пользователя / Администратора:

<img src="/readme_img/4.jpg" width="299" height="537"/>
<img src="/readme_img/5.jpg" width="516" height="537"/>

### **3. Просмотр заявок:**
- Пользователи могут видеть свои отправленные заявки на отдельной странице, разделенные на статусы отработки
- Администратор может видеть все заявки пользователей и отправлять на отработку "Заявки в работе"

<img src="/readme_img/6.jpg" width="434" height="640"/>
<img src="/readme_img/7.jpg" width="356" height="640"/>

### **4. Отработка заявок:**
По команде администратора на направление заявки на "Отработку" ему откроется страница с введением стоимости
по каждой услуге заявки

<img src="/readme_img/8.jpg" width="326" height="640"/>

После введения стоимости:
- администратору придёт сформированное коммерческое предложение в формате docx, которое останется только подписать

<img src="/readme_img/9.jpg" width="392" height="555"/>

- пользователю, придёт сообщение о том, что его заявка отработана с установленным ценовым предложением и в ближайшее 
время он получит подписанное коммерческое предложение

<img src="/readme_img/10.jpg" width="528" height="223"/>

